"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[5955],{2333:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>x,frontMatter:()=>o,metadata:()=>d,toc:()=>h});var r=t(4848),s=t(8453),i=t(1470),a=t(9365);const o={title:"Query",sidebar_custom_props:{sidebarActionType:"read"}},l="QueryCommand",d={id:"tables/actions/query/index",title:"Query",description:"Performs a Query Operation on a Table:",source:"@site/docs/2-tables/2-actions/2-query/index.md",sourceDirName:"2-tables/2-actions/2-query",slug:"/tables/actions/query/",permalink:"/docs/tables/actions/query/",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Query",sidebar_custom_props:{sidebarActionType:"read"}},sidebar:"tutorialSidebar",previous:{title:"Scan",permalink:"/docs/tables/actions/scan/"},next:{title:"DeletePartition",permalink:"/docs/tables/actions/deletePartition/"}},c={},h=[{value:"Request",id:"request",level:2},{value:"<code>.query(...)</code>",id:"query",level:3},{value:"<code>.entities(...)</code>",id:"entities",level:3},{value:"<code>.options(...)</code>",id:"options",level:3},{value:"Response",id:"response",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"querycommand",children:"QueryCommand"})}),"\n",(0,r.jsxs)(n.p,{children:["Performs a ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html",children:"Query Operation"})," on a ",(0,r.jsx)(n.code,{children:"Table"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import { QueryCommand } from 'dynamodb-toolbox/table/actions/query'\n\nconst queryCommand = PokeTable.build(QueryCommand)\n\nconst params = queryCommand.params()\nconst { Items } = await queryCommand.send()\n"})}),"\n",(0,r.jsx)(n.h2,{id:"request",children:"Request"}),"\n",(0,r.jsx)(n.h3,{id:"query",children:(0,r.jsx)(n.code,{children:".query(...)"})}),"\n",(0,r.jsx)("p",{style:{marginTop:"-15px"},children:(0,r.jsx)("i",{children:"(required)"})}),"\n",(0,r.jsx)(n.p,{children:"The partition to query, with optional index and range condition:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"partition"}),": The partition key to query"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)("code",{children:["index ",(0,r.jsx)("i",{children:"(optional)"})]}),": The name of a secondary index to query"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)("code",{children:["range ",(0,r.jsx)("i",{children:"(optional)"})]}),": If the table or index has a sort key, an additional ",(0,r.jsx)("a",{href:"../../entities/actions/parse-condition#range-conditions",children:"Range or Equality Condition"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// Get 'ashKetchum' pokemons\nawait PokeTable.build(QueryCommand)\n  .query({ partition: 'ashKetchum' })\n  .send()\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"Query"})," type to explicitly type an object as a ",(0,r.jsx)(n.code,{children:"QueryCommand"})," query object:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import type { Query } from 'dynamodb-toolbox/table/actions/query'\n\n// Get 'ashKetchum1' pokemons with a level \u2265 50\nconst query: Query<typeof PokeTable> = {\n  index: 'byTrainerId',\n  partition: 'ashKetchum1',\n  range: { gte: 50 }\n}\n\nconst { Items } = await PokeTable.build(QueryCommand)\n  .query(query)\n  .send()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"entities",children:(0,r.jsx)(n.code,{children:".entities(...)"})}),"\n",(0,r.jsxs)(n.p,{children:["Provides a list of entities to filter the returned items (via the internal ",(0,r.jsx)(n.a,{href:"/docs/entities/internal-attributes/#entity",children:(0,r.jsx)(n.code,{children:"entity"})})," attribute). Also ",(0,r.jsx)(n.strong,{children:"formats"})," them and ",(0,r.jsx)(n.strong,{children:"types"})," the response:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"// \ud83d\udc47 Typed as (Pokemon | Trainer)[]\nconst { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity, TrainerEntity)\n  .query(query)\n  .send()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"options",children:(0,r.jsx)(n.code,{children:".options(...)"})}),"\n",(0,r.jsx)(n.p,{children:"Provides additional options:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .options({\n    consistent: true,\n    limit: 10\n    ...\n  })\n  .send()\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"QueryOptions"})," type to explicitly type an object as a ",(0,r.jsx)(n.code,{children:"QueryCommand"})," options object:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import type { QueryOptions } from 'dynamodb-toolbox/table/actions/query'\n\nconst queryOptions: QueryOptions<\n  typeof PokeTable,\n  // \ud83d\udc47 Optional entities\n  [typeof PokemonEntity, typeof TrainerEntity]\n> = {\n  consistent: true,\n  limit: 10,\n  ...\n}\n\nconst { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity, TrainerEntity)\n  .query(query)\n  .options(queryOptions)\n  .send()\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["It is advised to provide ",(0,r.jsx)(n.code,{children:"entities"})," and ",(0,r.jsx)(n.code,{children:"query"})," first as they constrain the ",(0,r.jsx)(n.code,{children:"options"})," type."]})}),"\n",(0,r.jsxs)(n.p,{children:["Available options (see the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html#API_Query_RequestParameters",children:"DynamoDB documentation"})," for more details):"]}),"\n",(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Cat."}),(0,r.jsx)("th",{children:"Option"}),(0,r.jsx)("th",{children:"Type"}),(0,r.jsx)("th",{children:"Default"}),(0,r.jsx)("th",{children:"Description"})]})}),(0,r.jsxs)("tbody",{children:[(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{rowSpan:"5",align:"center",class:"vertical",children:(0,r.jsx)("b",{children:"General"})}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"consistent"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"boolean"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"false"})}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["By default, read operations are ",(0,r.jsx)("b",{children:"eventually"})," consistent (which improves performances and reduces costs).\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Set to ",(0,r.jsx)("code",{children:"true"})," to use ",(0,r.jsx)("b",{children:"strongly"})," consistent reads (unavailable on global secondary indexes)."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"reverse"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"boolean"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"false"})}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["Specifies the order for index traversal.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"By default, the traversal is performed in ascending order. If set to ",(0,r.jsx)("code",{children:"true"}),", the traversal is performed in descending order."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"capacity"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"CapacityOption"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:'"NONE"'})}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["Determines the level of detail about provisioned or on-demand throughput consumption that is returned in the response.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Possible values are ",(0,r.jsx)("code",{children:'"NONE"'}),", ",(0,r.jsx)("code",{children:'"TOTAL"'})," and ",(0,r.jsx)("code",{children:'"INDEXES"'}),"."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"tableName"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"string"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["Overrides the ",(0,r.jsx)("code",{children:"Table"})," name. Mostly useful for ",(0,r.jsx)("a",{href:"https://en.wikipedia.org/wiki/Multitenancy",children:"multitenancy"}),"."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"showEntityAttr"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"boolean"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"false"})}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["Includes the ",(0,r.jsx)("a",{href:"../../entities/internal-attributes#entity",children:(0,r.jsx)("code",{children:"entity"})})," internal attribute in the returned items. Useful for easily distinguishing items based on their entities."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{rowSpan:"3",align:"center",class:"vertical",children:(0,r.jsx)("b",{children:"Pagination"})}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"limit"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"integer \u2265 1"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["The maximum number of items to evaluate\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Note that DynamoDB may return a lower number of items if it reaches the limit of 1MB, or if filters are applied.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Applies for each page if ",(0,r.jsx)("code",{children:"maxPages"})," is used."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"exclusiveStartKey"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"Key"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsxs)("td",{children:["The primary key of the first item that this operation evaluates. Use the ",(0,r.jsx)("code",{children:"LastEvaluatedKey"})," from the previous operation."]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"maxPages"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"integer \u2265 1"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"1"})}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:['A "meta" option provided by DynamoDB-Toolbox to send multiple requests in a single promise.\n',(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Note that ",(0,r.jsx)("code",{children:"Infinity"})," is a valid (albeit dangerous) option.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"If two pages or more have been fetched, the responses ",(0,r.jsx)("code",{children:"Count"})," and ",(0,r.jsx)("code",{children:"ScannedCount"})," are summed, but the ",(0,r.jsx)("code",{children:"ConsumedCapacity"})," is omitted for the moment."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{rowSpan:"5",align:"center",class:"vertical",children:(0,r.jsx)("b",{children:"Filters"})}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"select"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"SelectOption"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["The strategy for returned attributes. You can retrieve all attributes, specific attributes, the count of matching items, or in the case of an index, some or all of the projected attributes.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Possible values are ",(0,r.jsx)("code",{children:'"ALL_ATTRIBUTES"'}),", ",(0,r.jsx)("code",{children:'"ALL_PROJECTED_ATTRIBUTES"'})," (if ",(0,r.jsx)("code",{children:"index"})," is specified), ",(0,r.jsx)("code",{children:'"COUNT"'})," and ",(0,r.jsx)("code",{children:'"SPECIFIC_ATTRIBUTES"'})," (if ",(0,r.jsx)("code",{children:"attributes"})," are specified)"]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"filters"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"Record<string, Condition>"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["For each entity name, a condition that must be satisfied in order for evaluated items of this entity to be returned (improves performances but does not reduce costs).\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Requires ",(0,r.jsx)("a",{href:"#entities",children:(0,r.jsx)("code",{children:"entities"})}),".\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"See the ",(0,r.jsx)("a",{href:"../../entities/actions/parse-condition#building-conditions",children:(0,r.jsx)("code",{children:"ConditionParser"})})," action for more details on how to write conditions."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"filter"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"Condition"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["An untyped condition that must be satisfied in order for evaluated items to be returned (improves performances but does not reduce costs).\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"No effect if ",(0,r.jsx)("a",{href:"#entities",children:(0,r.jsx)("code",{children:"entities"})})," are provided (use ",(0,r.jsx)("code",{children:"filters"})," instead).\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"See the ",(0,r.jsx)("a",{href:"../../entities/actions/parse-condition#building-conditions",children:(0,r.jsx)("code",{children:"ConditionParser"})})," action for more details on how to write conditions."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"attributes"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"string[]"})}),(0,r.jsx)("td",{align:"center",children:"-"}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["To specify a list of attributes to retrieve (improves performances but does not reduce costs).\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Requires ",(0,r.jsx)("a",{href:"#entities",children:(0,r.jsx)("code",{children:"entities"})}),". Paths must be common to all entities.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"See the ",(0,r.jsx)("a",{href:"../../entities/actions/parse-paths#paths",children:(0,r.jsx)("code",{children:"PathParser"})})," action for more details on how to write attribute paths."]})})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:"entityAttrFilter"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"boolean"})}),(0,r.jsx)("td",{align:"center",children:(0,r.jsx)("code",{children:"true"})}),(0,r.jsx)("td",{children:(0,r.jsxs)(n.p,{children:["By default, specifying ",(0,r.jsx)("a",{href:"#entities",children:(0,r.jsx)("code",{children:"entities"})})," introduces a ",(0,r.jsx)("a",{href:"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Scan.html#API_Scan_RequestSyntax",children:"Filter Expression"})," on the ",(0,r.jsx)("a",{href:"../../entities/internal-attributes#entity",children:(0,r.jsx)("code",{children:"entity"})})," internal attribute. Set this option to ",(0,r.jsx)("code",{children:"false"})," to disable this behavior.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"This option is useful for querying items that lack the ",(0,r.jsx)("a",{href:"../../entities/internal-attributes#entity",children:(0,r.jsx)("code",{children:"entity"})})," internal attribute (e.g., when migrating to DynamoDB-Toolbox). In this case, DynamoDB-Toolbox attempts to format the item for each entity and disregards it if none succeed.\n",(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),"Note that you can also use ",(0,r.jsx)("a",{href:"https://aws.amazon.com/fr/blogs/developer/middleware-stack-modular-aws-sdk-js/",children:"Middleware Stacks"})," to reintroduce the entity attribute."]})})]})]})]}),"\n",(0,r.jsx)(n.admonition,{title:"Examples",type:"note",children:(0,r.jsxs)(i.A,{children:[(0,r.jsx)(a.A,{value:"consistent",label:"Strongly consistent",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity)\n  .query({ partition: 'ashKetchum' })\n  .options({ consistent: true })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"indexed",label:"On index",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity)\n  .query({\n    index: 'byTrainerId',\n    partition: 'ashKetchum',\n    range: { gte: 50 }\n  })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"reverse",label:"Reversed",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity)\n  .query({ partition: 'ashKetchum' })\n  .options({ reverse: true })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"multitenant",label:"Multitenant",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity)\n  .query({ partition: 'ashKetchum' })\n  .options({ tableName: `tenant-${tenantId}-pokemons` })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"multi-entity",label:"Multi-Entities",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(TrainerEntity, PokemonEntity)\n  .query({ partition: 'ashKetchum' })\n  .options({ showEntityAttr: true })\n  .send()\n\nfor (const item of Items) {\n  switch (item.entity) {\n    case 'trainer':\n      // \ud83d\ude4c Typed as Trainer\n      ...\n    case 'pokemon':\n      // \ud83d\ude4c Typed as Pokemon\n      ...\n  }\n}\n"})})}),(0,r.jsx)(a.A,{value:"aborted",label:"Aborted",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const abortController = new AbortController()\nconst abortSignal = abortController.signal\n\nconst { Items } = await PokeTable.build(QueryCommand)\n  .query({ partition: 'ashKetchum' })\n  .send({ abortSignal })\n\n// \ud83d\udc47 Aborts the command\nabortController.abort()\n"})})})]})}),"\n",(0,r.jsx)(n.admonition,{title:"Paginated",type:"note",children:(0,r.jsxs)(i.A,{children:[(0,r.jsx)(a.A,{value:"paginated",label:"Paginated",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"let lastEvaluatedKey: Record<string, unknown> | undefined\nconst command = PokeTable.build(QueryCommand).query({\n  partition: 'ashKetchum'\n})\n\ndo {\n  const page = await command\n    .options({ exclusiveStartKey: lastEvaluatedKey })\n    .send()\n\n  // ...do something with page.Items here...\n\n  lastEvaluatedKey = page.LastEvaluatedKey\n} while (lastEvaluatedKey !== undefined)\n"})})}),(0,r.jsx)(a.A,{value:"partition",label:"All Partition",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .query({ partition: 'ashKetchum' })\n  // Retrieve all items from the partition (beware of RAM issues!)\n  .options({ maxPages: Infinity })\n  .send()\n"})})})]})}),"\n",(0,r.jsx)(n.admonition,{title:"Filtered",type:"note",children:(0,r.jsxs)(i.A,{children:[(0,r.jsx)(a.A,{value:"filters",label:"Filters",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity, TrainerEntity)\n  .query({ partition: 'ashKetchum' })\n  .options({\n    filters: {\n      POKEMONS: { attr: 'pokeType', eq: 'fire' },\n      TRAINERS: { attr: 'age', gt: 18 }\n    }\n  })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"filter",label:"Filter",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .query({ partition: 'ashKetchum' })\n  .options({\n    filter: { attr: 'pokeType', eq: 'fire' }\n  })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"attributes",label:"Attributes",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Items } = await PokeTable.build(QueryCommand)\n  .entities(PokemonEntity)\n  .query({ partition: 'ashKetchum' })\n  .options({ attributes: ['name', 'type'] })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"count",label:"Count",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const { Count } = await PokeTable.build(QueryCommand)\n  .query({ partition: 'ashKetchum' })\n  .options({ select: 'COUNT' })\n  .send()\n"})})}),(0,r.jsx)(a.A,{value:"aborted",label:"Aborted",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"const abortController = new AbortController()\nconst abortSignal = abortController.signal\n\nconst { Items } = await PokeTable.build(QueryCommand)\n  .query({ partition: 'ashKetchum' })\n  .send({ abortSignal })\n\n// \ud83d\udc47 Aborts the command\nabortController.abort()\n"})})})]})}),"\n",(0,r.jsx)(n.h2,{id:"response",children:"Response"}),"\n",(0,r.jsxs)(n.p,{children:["The data is returned using the same response syntax as the ",(0,r.jsx)(n.a,{href:"https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_Query.html#API_Query_ResponseElements",children:"DynamoDB Query API"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["If ",(0,r.jsx)(n.a,{href:"#entities",children:(0,r.jsx)(n.code,{children:"entities"})})," have been provided, the response ",(0,r.jsx)(n.code,{children:"Items"})," are formatted by their respective entities."]}),"\n",(0,r.jsxs)(n.p,{children:["You can use the ",(0,r.jsx)(n.code,{children:"QueryResponse"})," type to explicitly type an object as a ",(0,r.jsx)(n.code,{children:"QueryCommand"})," response object:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ts",children:"import type { QueryResponse } from 'dynamodb-toolbox/table/actions/query'\n\nconst queryResponse: QueryResponse<\n  typeof PokeTable,\n  // \ud83d\udc47 Query\n  { partition: 'ashKetchum' },\n  // \ud83d\udc47 Optional entities\n  [typeof PokemonEntity],\n  // \ud83d\udc47 Optional options\n  { attributes: ['name', 'type'] }\n> = { Items: ... }\n"})})]})}function x(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},9365:(e,n,t)=>{t.d(n,{A:()=>a});t(6540);var r=t(8215);const s={tabItem:"tabItem_Ymn6"};var i=t(4848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,a),hidden:t,children:n})}},1470:(e,n,t)=>{t.d(n,{A:()=>T});var r=t(6540),s=t(8215),i=t(3104),a=t(6347),o=t(205),l=t(7485),d=t(1682),c=t(679);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:s}}=e;return{value:n,label:t,attributes:r,default:s}}))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function x(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:t}=e;const s=(0,a.W6)(),i=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(i),(0,r.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(s.location.search);n.set(i,e),s.replace({...s.location,search:n.toString()})}),[i,s])]}function j(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=u(e),[a,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!x({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:i}))),[d,h]=m({queryString:t,groupId:s}),[j,p]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,i]=(0,c.Dv)(t);return[s,(0,r.useCallback)((e=>{t&&i.set(e)}),[t,i])]}({groupId:s}),b=(()=>{const e=d??j;return x({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{b&&l(b)}),[b]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!x({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),p(e)}),[h,p,i]),tabValues:i}}var p=t(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(4848);function f(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),s=o[t].value;s!==r&&(d(n),a(s))},h=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:i}=e;return(0,y.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>l.push(e),onKeyDown:h,onClick:c,...i,className:(0,s.A)("tabs__item",b.tabItem,i?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function g(e){let{lazy:n,children:t,selectedValue:i}=e;const a=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=a.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:a.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function v(e){const n=j(e);return(0,y.jsxs)("div",{className:(0,s.A)("tabs-container",b.tabList),children:[(0,y.jsx)(f,{...n,...e}),(0,y.jsx)(g,{...n,...e})]})}function T(e){const n=(0,p.A)();return(0,y.jsx)(v,{...e,children:h(e.children)},String(n))}},8453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>o});var r=t(6540);const s={},i=r.createContext(s);function a(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);